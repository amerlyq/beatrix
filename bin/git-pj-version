#!/usr/bin/env bash
#
# SPDX-FileCopyrightText: 2019 Dmytro Kolomoiets <amerlyq@gmail.com> and contributors.
#
# SPDX-License-Identifier: MIT
#
#%SUMMARY: get project version from git
#%USAGE: $ ./$0 [/path/to/dir..]
#%
set -o errexit -o errtrace -o noclobber -o noglob -o nounset -o pipefail

d_git=${1-}

## ALT: use date of last commit
#   git --no-pager log --pretty=format:'%ad' --date=short -1 || echo 0
# OR: rev=$("${git[@]}" rev-list --count HEAD -- '^master')

tag=$(git ${d_git:+-C "$d_git"} describe --always --dirty --tags --match '*.*.*')

echo "${tag/-/.}"
